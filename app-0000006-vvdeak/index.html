<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RPGエフェクトジェネレーター v6.0 - 超格好良いゲームエフェクト生成ツール">
    <meta name="theme-color" content="#1a0033">
    <title>RPGエフェクトジェネレーター v6.0 - Ultimate Effect Generator</title>
    
    <!-- PWA対応 -->
    <link rel="manifest" href="data:application/json,{%22name%22:%22RPGエフェクトジェネレーター%22,%22short_name%22:%22RPG%20Effects%22,%22start_url%22:%22.%22,%22display%22:%22standalone%22,%22theme_color%22:%22%231a0033%22,%22background_color%22:%22%230a0015%22}">
    
    <style>
        /* CSS変数 */
        :root {
            --primary: #9945ff;
            --primary-glow: #b366ff;
            --secondary: #00ff88;
            --secondary-glow: #33ffaa;
            --accent: #ff0066;
            --accent-glow: #ff3388;
            --holy: #ffeb3b;
            --holy-glow: #fff59d;
            --dark: #0a0015;
            --darker: #050010;
            --gray-900: #1a0033;
            --gray-800: #2d0055;
            --gray-700: #400077;
            --gray-600: #5500aa;
            --gray-500: #7722dd;
            --gray-400: #9945ff;
            --gray-300: #bb77ff;
            --gray-200: #ddaaff;
            --gray-100: #f0ddff;
            --white: #ffffff;
            --shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.8);
            --shadow-xl: 0 30px 60px -15px rgba(0, 0, 0, 0.9);
            --gradient-primary: linear-gradient(135deg, #9945ff 0%, #ff0066 100%);
            --gradient-dark: linear-gradient(180deg, #1a0033 0%, #0a0015 100%);
            --gradient-fire: linear-gradient(135deg, #ff0066 0%, #ffeb3b 100%);
            --gradient-ice: linear-gradient(135deg, #00ffff 0%, #0066ff 100%);
            --gradient-thunder: linear-gradient(135deg, #ffeb3b 0%, #9945ff 100%);
            --gradient-holy: linear-gradient(135deg, #ffffff 0%, #ffeb3b 100%);
            --gradient-darkness: linear-gradient(135deg, #000000 0%, #9945ff 100%);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --border-radius: 0.75rem;
            --font-game: 'Orbitron', 'Courier New', monospace;
        }

        /* フォント読み込み */
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

        /* リセット */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ベーススタイル */
        body {
            font-family: var(--font-game);
            background: var(--darker);
            color: var(--gray-100);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* 背景エフェクト */
        .bg-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            opacity: 0;
            animation: floatParticle 10s infinite;
        }

        @keyframes floatParticle {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0);
            }
            10% {
                opacity: 0.8;
                transform: translateY(90vh) scale(1);
            }
            90% {
                opacity: 0.8;
                transform: translateY(10vh) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(0) scale(0);
            }
        }

        /* メインコンテナ */
        .app-container {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* ヘッダー */
        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 1s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(153, 69, 255, 0.5);
            margin-bottom: 0.5rem;
            letter-spacing: 0.1em;
        }

        .header p {
            font-size: 1.25rem;
            color: var(--gray-400);
            text-shadow: 0 0 10px currentColor;
        }

        /* バトルステージ */
        .battle-stage {
            background: var(--gradient-dark);
            border: 2px solid var(--gray-700);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-xl), inset 0 0 50px rgba(153, 69, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .stage-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: radial-gradient(ellipse at center, rgba(153, 69, 255, 0.1) 0%, transparent 70%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 敵キャラクター */
        .enemy-container {
            position: relative;
            z-index: 10;
        }

        .enemy {
            width: 200px;
            height: 200px;
            background: var(--gradient-darkness);
            border-radius: 50%;
            border: 3px solid var(--primary);
            box-shadow: 0 0 50px rgba(153, 69, 255, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            transition: var(--transition);
        }

        .enemy.hit {
            animation: enemyHit 0.5s ease-out;
        }

        @keyframes enemyHit {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* エフェクトレイヤー */
        .effects-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }

        /* コントロールパネル */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .control-section {
            background: var(--gray-900);
            border: 1px solid var(--gray-700);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .control-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
            text-shadow: 0 0 10px currentColor;
        }

        /* エフェクトボタン */
        .effect-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .effect-btn {
            background: linear-gradient(145deg, var(--gray-800), var(--gray-700));
            border: 2px solid var(--gray-600);
            border-radius: 0.5rem;
            padding: 1rem;
            color: var(--gray-200);
            font-family: var(--font-game);
            font-size: 0.875rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .effect-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .effect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(153, 69, 255, 0.5);
            border-color: var(--primary);
            color: var(--white);
        }

        .effect-btn:hover::before {
            left: 100%;
        }

        .effect-btn:active {
            transform: translateY(0);
        }

        .effect-btn.fire { border-color: #ff4444; }
        .effect-btn.fire:hover { box-shadow: 0 10px 20px -5px rgba(255, 68, 68, 0.8); }

        .effect-btn.ice { border-color: #44aaff; }
        .effect-btn.ice:hover { box-shadow: 0 10px 20px -5px rgba(68, 170, 255, 0.8); }

        .effect-btn.thunder { border-color: #ffeb3b; }
        .effect-btn.thunder:hover { box-shadow: 0 10px 20px -5px rgba(255, 235, 59, 0.8); }

        .effect-btn.holy { border-color: #ffffff; }
        .effect-btn.holy:hover { box-shadow: 0 10px 20px -5px rgba(255, 255, 255, 0.8); }

        .effect-btn.darkness { border-color: #9945ff; }
        .effect-btn.darkness:hover { box-shadow: 0 10px 20px -5px rgba(153, 69, 255, 0.8); }

        /* 設定パネル */
        .settings-grid {
            display: grid;
            gap: 1rem;
        }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .setting-label {
            color: var(--gray-300);
            font-size: 0.875rem;
        }

        .setting-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        input[type="range"] {
            width: 150px;
            height: 6px;
            background: var(--gray-700);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(153, 69, 255, 0.8);
        }

        .setting-value {
            min-width: 50px;
            text-align: right;
            color: var(--primary);
            font-weight: 700;
        }

        /* エフェクトプリセット */
        .preset-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .preset-tab {
            background: var(--gray-800);
            border: 1px solid var(--gray-600);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            color: var(--gray-400);
            font-size: 0.875rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        .preset-tab.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(153, 69, 255, 0.5);
        }

        /* ダメージ表示 */
        .damage-number {
            position: absolute;
            font-size: 3rem;
            font-weight: 900;
            color: var(--white);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            pointer-events: none;
            z-index: 100;
            animation: damageFloat 1.5s ease-out forwards;
        }

        @keyframes damageFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(0.5);
            }
            50% {
                opacity: 1;
                transform: translateY(-50px) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.8);
            }
        }

        .damage-critical {
            color: var(--accent);
            font-size: 4rem;
            animation: damageCritical 2s ease-out forwards;
        }

        @keyframes damageCritical {
            0% {
                opacity: 1;
                transform: translateY(0) scale(0.5) rotate(-15deg);
            }
            25% {
                transform: translateY(-30px) scale(1.5) rotate(15deg);
            }
            50% {
                opacity: 1;
                transform: translateY(-60px) scale(1.2) rotate(-10deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-120px) scale(0.8) rotate(0);
            }
        }

        /* エフェクトアニメーション */
        .effect-slash {
            position: absolute;
            width: 300px;
            height: 300px;
            pointer-events: none;
        }

        .slash-line {
            position: absolute;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--white), transparent);
            top: 50%;
            left: 0;
            transform-origin: center;
            animation: slashAnimation 0.3s ease-out forwards;
        }

        @keyframes slashAnimation {
            0% {
                transform: translateX(-100%) scaleX(0) rotate(45deg);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateX(0) scaleX(1.5) rotate(45deg);
                opacity: 0;
            }
        }

        /* 爆発エフェクト */
        .effect-explosion {
            position: absolute;
            width: 400px;
            height: 400px;
            pointer-events: none;
        }

        .explosion-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 4px solid var(--accent);
            border-radius: 50%;
            opacity: 0;
            animation: explosionRing 1s ease-out forwards;
        }

        @keyframes explosionRing {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .explosion-particle {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--accent);
            border-radius: 50%;
            animation: explosionParticle 1s ease-out forwards;
        }

        @keyframes explosionParticle {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        /* 雷エフェクト */
        .effect-thunder {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            filter: brightness(2) contrast(2);
        }

        .thunder-bolt {
            position: absolute;
            width: 4px;
            height: 300px;
            background: linear-gradient(to bottom, transparent, var(--holy), transparent);
            top: -300px;
            left: 50%;
            transform: translateX(-50%);
            animation: thunderStrike 0.5s ease-out forwards;
        }

        @keyframes thunderStrike {
            0% {
                opacity: 0;
                transform: translateX(-50%) scaleY(0);
            }
            50% {
                opacity: 1;
                transform: translateX(-50%) scaleY(1);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scaleY(1);
            }
        }

        /* 聖なる光エフェクト */
        .effect-holy {
            position: absolute;
            width: 500px;
            height: 500px;
            pointer-events: none;
        }

        .holy-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
            animation: holyPulse 2s ease-out forwards;
        }

        @keyframes holyPulse {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        /* 闇エフェクト */
        .effect-darkness {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: radial-gradient(circle, transparent 0%, rgba(0, 0, 0, 0.9) 50%);
            animation: darknessPulse 1.5s ease-out forwards;
        }

        @keyframes darknessPulse {
            0% {
                opacity: 0;
                transform: scale(1.5);
            }
            50% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0.8);
            }
        }

        /* 魔法陣エフェクト */
        .magic-circle {
            position: absolute;
            width: 300px;
            height: 300px;
            border: 3px solid var(--primary);
            border-radius: 50%;
            animation: magicRotate 3s linear infinite;
        }

        .magic-circle::before,
        .magic-circle::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px solid var(--primary);
            border-radius: 50%;
            opacity: 0.5;
        }

        .magic-circle::before {
            transform: scale(0.8);
            animation: magicPulse 2s ease-in-out infinite;
        }

        .magic-circle::after {
            transform: scale(1.2);
            animation: magicPulse 2s ease-in-out infinite reverse;
        }

        @keyframes magicRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes magicPulse {
            0%, 100% { opacity: 0.2; transform: scale(0.8); }
            50% { opacity: 0.8; transform: scale(1.2); }
        }

        /* ステータスバー */
        .status-bar {
            background: var(--gray-900);
            border: 1px solid var(--gray-700);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .status-item {
            text-align: center;
        }

        .status-label {
            font-size: 0.75rem;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .status-value {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--primary);
            text-shadow: 0 0 10px currentColor;
        }

        /* レスポンシブ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .controls {
                grid-template-columns: 1fr;
            }

            .stage-container {
                height: 400px;
            }

            .enemy {
                width: 150px;
                height: 150px;
                font-size: 3rem;
            }

            .effect-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ローディング */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeOut 1s ease-out 2s forwards;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        .loading-text {
            font-size: 2rem;
            font-weight: 900;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
        }
    </style>
</head>
<body>
    <!-- ローディング -->
    <div class="loading">
        <div class="loading-text">LOADING...</div>
    </div>

    <!-- 背景パーティクル -->
    <div class="bg-particles" id="bgParticles"></div>

    <!-- メインアプリ -->
    <div class="app-container">
        <!-- ヘッダー -->
        <header class="header">
            <h1>⚔️ RPG EFFECT GENERATOR</h1>
            <p>究極のゲームエフェクト生成ツール v6.0</p>
        </header>

        <!-- ステータスバー -->
        <div class="status-bar">
            <div class="status-item">
                <div class="status-label">Total Damage</div>
                <div class="status-value" id="totalDamage">0</div>
            </div>
            <div class="status-item">
                <div class="status-label">Combo</div>
                <div class="status-value" id="comboCount">0</div>
            </div>
            <div class="status-item">
                <div class="status-label">Effects Used</div>
                <div class="status-value" id="effectsUsed">0</div>
            </div>
        </div>

        <!-- バトルステージ -->
        <div class="battle-stage">
            <div class="stage-container" id="battleStage">
                <div class="enemy-container">
                    <div class="enemy" id="enemy">👹</div>
                </div>
                <div class="effects-layer" id="effectsLayer"></div>
            </div>
        </div>

        <!-- コントロールパネル -->
        <div class="controls">
            <!-- エフェクト選択 -->
            <div class="control-section">
                <h3 class="control-title">🎮 Attack Effects</h3>
                
                <!-- プリセットタブ -->
                <div class="preset-tabs">
                    <button class="preset-tab active" onclick="rpgEffects.switchPreset('physical')">物理攻撃</button>
                    <button class="preset-tab" onclick="rpgEffects.switchPreset('magic')">魔法攻撃</button>
                    <button class="preset-tab" onclick="rpgEffects.switchPreset('special')">必殺技</button>
                    <button class="preset-tab" onclick="rpgEffects.switchPreset('ultimate')">究極技</button>
                </div>

                <!-- エフェクトボタン -->
                <div class="effect-grid" id="effectButtons">
                    <!-- 物理攻撃 -->
                    <button class="effect-btn" onclick="rpgEffects.playEffect('slash')">
                        ⚔️ 斬撃
                    </button>
                    <button class="effect-btn" onclick="rpgEffects.playEffect('doubleSlash')">
                        ⚔️⚔️ 二段斬り
                    </button>
                    <button class="effect-btn" onclick="rpgEffects.playEffect('heavySlash')">
                        🗡️ 重撃
                    </button>
                    <button class="effect-btn" onclick="rpgEffects.playEffect('pierce')">
                        🏹 貫通
                    </button>
                    <button class="effect-btn" onclick="rpgEffects.playEffect('smash')">
                        🔨 粉砕
                    </button>
                    <button class="effect-btn" onclick="rpgEffects.playEffect('combo')">
                        👊 連撃
                    </button>
                </div>
            </div>

            <!-- 設定パネル -->
            <div class="control-section">
                <h3 class="control-title">⚙️ Effect Settings</h3>
                
                <div class="settings-grid">
                    <div class="setting-item">
                        <span class="setting-label">エフェクト強度</span>
                        <div class="setting-control">
                            <input type="range" id="effectIntensity" min="50" max="200" value="100">
                            <span class="setting-value" id="intensityValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">アニメーション速度</span>
                        <div class="setting-control">
                            <input type="range" id="animationSpeed" min="50" max="200" value="100">
                            <span class="setting-value" id="speedValue">100%</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">ダメージ倍率</span>
                        <div class="setting-control">
                            <input type="range" id="damageMultiplier" min="1" max="10" value="1">
                            <span class="setting-value" id="damageValue">x1</span>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">サウンド</span>
                        <div class="setting-control">
                            <input type="checkbox" id="soundEnabled" checked>
                            <label for="soundEnabled">ON</label>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">画面振動</span>
                        <div class="setting-control">
                            <input type="checkbox" id="screenShake" checked>
                            <label for="screenShake">ON</label>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <span class="setting-label">自動連続再生</span>
                        <div class="setting-control">
                            <input type="checkbox" id="autoPlay">
                            <label for="autoPlay">OFF</label>
                        </div>
                    </div>
                </div>

                <!-- アクションボタン -->
                <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
                    <button class="effect-btn" style="flex: 1; background: var(--gradient-primary);" onclick="rpgEffects.playRandomEffect()">
                        🎲 ランダム
                    </button>
                    <button class="effect-btn" style="flex: 1; background: var(--gradient-fire);" onclick="rpgEffects.playUltimate()">
                        💥 究極技
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // RPGエフェクトジェネレータークラス
        class RPGEffectGenerator {
            constructor() {
                this.totalDamage = 0;
                this.comboCount = 0;
                this.effectsUsed = 0;
                this.currentPreset = 'physical';
                this.settings = {
                    intensity: 100,
                    speed: 100,
                    damageMultiplier: 1,
                    soundEnabled: true,
                    screenShake: true,
                    autoPlay: false
                };
                
                this.effects = {
                    physical: [
                        { id: 'slash', name: '⚔️ 斬撃', damage: [80, 120], color: '#ffffff' },
                        { id: 'doubleSlash', name: '⚔️⚔️ 二段斬り', damage: [60, 80], color: '#ffffff' },
                        { id: 'heavySlash', name: '🗡️ 重撃', damage: [150, 200], color: '#ff6666' },
                        { id: 'pierce', name: '🏹 貫通', damage: [90, 110], color: '#66ff66' },
                        { id: 'smash', name: '🔨 粉砕', damage: [120, 180], color: '#ffaa66' },
                        { id: 'combo', name: '👊 連撃', damage: [30, 50], color: '#66aaff' }
                    ],
                    magic: [
                        { id: 'fireball', name: '🔥 ファイアボール', damage: [100, 150], color: '#ff4444' },
                        { id: 'iceSpear', name: '❄️ アイススピア', damage: [80, 120], color: '#44aaff' },
                        { id: 'thunder', name: '⚡ サンダー', damage: [110, 160], color: '#ffeb3b' },
                        { id: 'holy', name: '✨ ホーリー', damage: [130, 170], color: '#ffffff' },
                        { id: 'darkness', name: '🌑 ダークネス', damage: [140, 180], color: '#9945ff' },
                        { id: 'meteor', name: '☄️ メテオ', damage: [200, 300], color: '#ff6600' }
                    ],
                    special: [
                        { id: 'bladeDance', name: '🌪️ 剣の舞', damage: [50, 70], color: '#66ffff' },
                        { id: 'dragonSlash', name: '🐉 竜撃斬', damage: [180, 250], color: '#ff00ff' },
                        { id: 'phoenixStrike', name: '🔥 鳳凰撃', damage: [160, 220], color: '#ff6666' },
                        { id: 'voidSlash', name: '🌌 虚空斬', damage: [170, 230], color: '#000000' },
                        { id: 'lightningBlade', name: '⚡ 雷刃', damage: [150, 200], color: '#ffff00' },
                        { id: 'starfall', name: '⭐ 流星群', damage: [40, 60], color: '#ffffff' }
                    ],
                    ultimate: [
                        { id: 'omnislash', name: '🌟 全方位斬撃', damage: [300, 500], color: '#ffffff' },
                        { id: 'apocalypse', name: '💀 アポカリプス', damage: [400, 600], color: '#ff0000' },
                        { id: 'divineJudgment', name: '⚖️ 神の裁き', damage: [350, 550], color: '#ffeb3b' },
                        { id: 'chaosBlast', name: '🌀 カオスブラスト', damage: [380, 580], color: '#9945ff' },
                        { id: 'infinityEdge', name: '♾️ 無限刃', damage: [450, 650], color: '#00ffff' },
                        { id: 'finalFantasy', name: '🏆 ファイナルファンタジー', damage: [500, 1000], color: '#ff00ff' }
                    ]
                };
                
                this.audioContext = null;
                this.init();
            }

            init() {
                console.log('⚔️ RPG Effect Generator v6.0 initialized');
                this.createBackgroundParticles();
                this.setupEventListeners();
                this.updateEffectButtons();
                
                // Web Audio API初期化
                window.addEventListener('click', () => {
                    if (!this.audioContext) {
                        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }
                }, { once: true });
            }

            createBackgroundParticles() {
                const container = document.getElementById('bgParticles');
                for (let i = 0; i < 50; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                    container.appendChild(particle);
                }
            }

            setupEventListeners() {
                // 設定スライダー
                document.getElementById('effectIntensity').addEventListener('input', (e) => {
                    this.settings.intensity = e.target.value;
                    document.getElementById('intensityValue').textContent = e.target.value + '%';
                });

                document.getElementById('animationSpeed').addEventListener('input', (e) => {
                    this.settings.speed = e.target.value;
                    document.getElementById('speedValue').textContent = e.target.value + '%';
                });

                document.getElementById('damageMultiplier').addEventListener('input', (e) => {
                    this.settings.damageMultiplier = e.target.value;
                    document.getElementById('damageValue').textContent = 'x' + e.target.value;
                });

                document.getElementById('soundEnabled').addEventListener('change', (e) => {
                    this.settings.soundEnabled = e.target.checked;
                });

                document.getElementById('screenShake').addEventListener('change', (e) => {
                    this.settings.screenShake = e.target.checked;
                });

                document.getElementById('autoPlay').addEventListener('change', (e) => {
                    this.settings.autoPlay = e.target.checked;
                    if (e.target.checked) {
                        this.startAutoPlay();
                    }
                });
            }

            switchPreset(preset) {
                this.currentPreset = preset;
                
                // タブの状態更新
                document.querySelectorAll('.preset-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                event.target.classList.add('active');
                
                this.updateEffectButtons();
            }

            updateEffectButtons() {
                const container = document.getElementById('effectButtons');
                container.innerHTML = '';
                
                const effects = this.effects[this.currentPreset];
                effects.forEach(effect => {
                    const btn = document.createElement('button');
                    btn.className = 'effect-btn';
                    btn.textContent = effect.name;
                    btn.onclick = () => this.playEffect(effect.id);
                    
                    // 属性に応じた色設定
                    if (effect.color) {
                        btn.style.borderColor = effect.color;
                    }
                    
                    container.appendChild(btn);
                });
            }

            playEffect(effectId) {
                // エフェクトを検索
                let effect = null;
                for (const preset in this.effects) {
                    const found = this.effects[preset].find(e => e.id === effectId);
                    if (found) {
                        effect = found;
                        break;
                    }
                }
                
                if (!effect) return;
                
                // エフェクト実行
                this.executeEffect(effect);
                
                // 統計更新
                this.effectsUsed++;
                document.getElementById('effectsUsed').textContent = this.effectsUsed;
                
                // 自動再生
                if (this.settings.autoPlay) {
                    setTimeout(() => this.playRandomEffect(), 2000 / (this.settings.speed / 100));
                }
            }

            executeEffect(effect) {
                const stage = document.getElementById('battleStage');
                const enemy = document.getElementById('enemy');
                const effectsLayer = document.getElementById('effectsLayer');
                
                // 画面振動
                if (this.settings.screenShake) {
                    this.shakeScreen();
                }
                
                // 敵ヒットアニメーション
                enemy.classList.add('hit');
                setTimeout(() => enemy.classList.remove('hit'), 500);
                
                // ダメージ計算
                const minDamage = effect.damage[0] * this.settings.damageMultiplier;
                const maxDamage = effect.damage[1] * this.settings.damageMultiplier;
                const damage = Math.floor(minDamage + Math.random() * (maxDamage - minDamage));
                const isCritical = Math.random() < 0.2;
                
                // ダメージ表示
                this.showDamage(damage, isCritical);
                
                // エフェクト描画
                this.drawEffect(effect, effectsLayer);
                
                // サウンド再生
                if (this.settings.soundEnabled && this.audioContext) {
                    this.playSound(effect);
                }
                
                // コンボ更新
                this.updateCombo();
            }

            drawEffect(effect, container) {
                const effectDiv = document.createElement('div');
                effectDiv.style.position = 'absolute';
                effectDiv.style.top = '50%';
                effectDiv.style.left = '50%';
                effectDiv.style.transform = 'translate(-50%, -50%)';
                effectDiv.style.width = '400px';
                effectDiv.style.height = '400px';
                effectDiv.style.pointerEvents = 'none';
                
                // エフェクトタイプに応じた描画
                switch (effect.id) {
                    case 'slash':
                    case 'doubleSlash':
                    case 'heavySlash':
                        this.drawSlashEffect(effectDiv, effect);
                        break;
                    case 'fireball':
                    case 'meteor':
                        this.drawExplosionEffect(effectDiv, effect);
                        break;
                    case 'thunder':
                    case 'lightningBlade':
                        this.drawThunderEffect(effectDiv, effect);
                        break;
                    case 'holy':
                    case 'divineJudgment':
                        this.drawHolyEffect(effectDiv, effect);
                        break;
                    case 'darkness':
                    case 'voidSlash':
                        this.drawDarknessEffect(effectDiv, effect);
                        break;
                    default:
                        this.drawGenericEffect(effectDiv, effect);
                }
                
                container.appendChild(effectDiv);
                
                // エフェクト削除
                const duration = effect.id.includes('ultimate') ? 3000 : 1500;
                setTimeout(() => effectDiv.remove(), duration / (this.settings.speed / 100));
            }

            drawSlashEffect(container, effect) {
                const slashCount = effect.id === 'doubleSlash' ? 2 : 1;
                
                for (let i = 0; i < slashCount; i++) {
                    const slash = document.createElement('div');
                    slash.className = 'effect-slash';
                    slash.style.animationDelay = i * 0.2 + 's';
                    
                    const line = document.createElement('div');
                    line.className = 'slash-line';
                    line.style.background = `linear-gradient(90deg, transparent, ${effect.color}, transparent)`;
                    line.style.transform = `rotate(${-45 + Math.random() * 90}deg)`;
                    line.style.height = effect.id === 'heavySlash' ? '8px' : '4px';
                    
                    slash.appendChild(line);
                    container.appendChild(slash);
                }
            }

            drawExplosionEffect(container, effect) {
                // 爆発リング
                for (let i = 0; i < 3; i++) {
                    const ring = document.createElement('div');
                    ring.className = 'explosion-ring';
                    ring.style.borderColor = effect.color;
                    ring.style.animationDelay = i * 0.1 + 's';
                    container.appendChild(ring);
                }
                
                // 爆発パーティクル
                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'explosion-particle';
                    particle.style.background = effect.color;
                    particle.style.left = '50%';
                    particle.style.top = '50%';
                    particle.style.setProperty('--tx', (Math.random() - 0.5) * 300 + 'px');
                    particle.style.setProperty('--ty', (Math.random() - 0.5) * 300 + 'px');
                    container.appendChild(particle);
                }
            }

            drawThunderEffect(container, effect) {
                const thunder = document.createElement('div');
                thunder.className = 'effect-thunder';
                
                for (let i = 0; i < 5; i++) {
                    const bolt = document.createElement('div');
                    bolt.className = 'thunder-bolt';
                    bolt.style.left = (30 + Math.random() * 40) + '%';
                    bolt.style.animationDelay = i * 0.1 + 's';
                    bolt.style.background = `linear-gradient(to bottom, transparent, ${effect.color}, transparent)`;
                    thunder.appendChild(bolt);
                }
                
                container.appendChild(thunder);
            }

            drawHolyEffect(container, effect) {
                const holy = document.createElement('div');
                holy.className = 'effect-holy';
                
                const circle = document.createElement('div');
                circle.className = 'holy-circle';
                holy.appendChild(circle);
                
                // 魔法陣追加
                const magicCircle = document.createElement('div');
                magicCircle.className = 'magic-circle';
                magicCircle.style.borderColor = effect.color;
                holy.appendChild(magicCircle);
                
                container.appendChild(holy);
            }

            drawDarknessEffect(container, effect) {
                const darkness = document.createElement('div');
                darkness.className = 'effect-darkness';
                container.appendChild(darkness);
            }

            drawGenericEffect(container, effect) {
                // 汎用的なパーティクルエフェクト
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.width = '10px';
                    particle.style.height = '10px';
                    particle.style.background = effect.color;
                    particle.style.borderRadius = '50%';
                    particle.style.left = '50%';
                    particle.style.top = '50%';
                    
                    const angle = (Math.PI * 2 / 30) * i;
                    const distance = 100 + Math.random() * 100;
                    const x = Math.cos(angle) * distance;
                    const y = Math.sin(angle) * distance;
                    
                    particle.style.animation = `genericParticle 1s ease-out forwards`;
                    particle.style.setProperty('--tx', x + 'px');
                    particle.style.setProperty('--ty', y + 'px');
                    
                    container.appendChild(particle);
                }
                
                // CSSアニメーション追加
                if (!document.getElementById('genericParticleStyle')) {
                    const style = document.createElement('style');
                    style.id = 'genericParticleStyle';
                    style.textContent = `
                        @keyframes genericParticle {
                            0% {
                                transform: translate(-50%, -50%) scale(0);
                                opacity: 1;
                            }
                            100% {
                                transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(0);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            showDamage(damage, isCritical = false) {
                const damageDiv = document.createElement('div');
                damageDiv.className = 'damage-number' + (isCritical ? ' damage-critical' : '');
                damageDiv.textContent = damage + (isCritical ? '!!' : '');
                damageDiv.style.left = '50%';
                damageDiv.style.top = '50%';
                damageDiv.style.transform = 'translate(-50%, -50%)';
                
                const stage = document.getElementById('battleStage');
                stage.appendChild(damageDiv);
                
                // ダメージ統計更新
                this.totalDamage += damage;
                document.getElementById('totalDamage').textContent = this.totalDamage;
                
                // アニメーション後に削除
                setTimeout(() => damageDiv.remove(), 2000);
            }

            updateCombo() {
                this.comboCount++;
                document.getElementById('comboCount').textContent = this.comboCount;
                
                // コンボリセットタイマー
                clearTimeout(this.comboTimer);
                this.comboTimer = setTimeout(() => {
                    this.comboCount = 0;
                    document.getElementById('comboCount').textContent = this.comboCount;
                }, 3000);
            }

            shakeScreen() {
                const stage = document.querySelector('.battle-stage');
                stage.style.animation = 'none';
                setTimeout(() => {
                    stage.style.animation = 'screenShake 0.5s ease-out';
                }, 10);
                
                // アニメーション定義
                if (!document.getElementById('screenShakeStyle')) {
                    const style = document.createElement('style');
                    style.id = 'screenShakeStyle';
                    style.textContent = `
                        @keyframes screenShake {
                            0%, 100% { transform: translateX(0); }
                            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
                            20%, 40%, 60%, 80% { transform: translateX(10px); }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }

            playSound(effect) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                // エフェクトタイプに応じた音設定
                switch (effect.id) {
                    case 'slash':
                    case 'doubleSlash':
                        oscillator.frequency.setValueAtTime(800, this.audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(200, this.audioContext.currentTime + 0.1);
                        gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.1);
                        break;
                    case 'explosion':
                    case 'fireball':
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.setValueAtTime(100, this.audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(50, this.audioContext.currentTime + 0.3);
                        gainNode.gain.setValueAtTime(0.5, this.audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.3);
                        break;
                    case 'thunder':
                        oscillator.type = 'square';
                        oscillator.frequency.setValueAtTime(200, this.audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(100, this.audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(300, this.audioContext.currentTime + 0.2);
                        gainNode.gain.setValueAtTime(0.4, this.audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.5);
                        break;
                    default:
                        oscillator.frequency.setValueAtTime(440, this.audioContext.currentTime);
                        gainNode.gain.setValueAtTime(0.2, this.audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + 0.2);
                }
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + 0.5);
            }

            playRandomEffect() {
                const allEffects = Object.values(this.effects).flat();
                const randomEffect = allEffects[Math.floor(Math.random() * allEffects.length)];
                this.executeEffect(randomEffect);
                
                this.effectsUsed++;
                document.getElementById('effectsUsed').textContent = this.effectsUsed;
            }

            playUltimate() {
                // 究極技：すべてのエフェクトを連続再生
                const ultimateSequence = [
                    { delay: 0, effect: 'darkness' },
                    { delay: 500, effect: 'magicCircle' },
                    { delay: 1000, effect: 'thunder' },
                    { delay: 1500, effect: 'explosion' },
                    { delay: 2000, effect: 'holy' },
                    { delay: 2500, effect: 'finalSlash' }
                ];
                
                ultimateSequence.forEach(seq => {
                    setTimeout(() => {
                        const effect = this.effects.ultimate.find(e => e.id === 'infinityEdge') || this.effects.ultimate[0];
                        this.executeEffect(effect);
                    }, seq.delay / (this.settings.speed / 100));
                });
            }

            startAutoPlay() {
                if (this.settings.autoPlay) {
                    this.playRandomEffect();
                }
            }
        }

        // グローバル変数
        let rpgEffects;

        // 初期化
        document.addEventListener('DOMContentLoaded', () => {
            rpgEffects = new RPGEffectGenerator();
            
            // PWA Service Worker登録
            if ('serviceWorker' in navigator && location.protocol === 'https:') {
                const swContent = `
                    self.addEventListener('install', event => {
                        self.skipWaiting();
                    });

                    self.addEventListener('activate', event => {
                        event.waitUntil(clients.claim());
                    });

                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            fetch(event.request).catch(() => {
                                return new Response('オフラインです', {
                                    status: 503,
                                    statusText: 'Service Unavailable',
                                    headers: new Headers({
                                        'Content-Type': 'text/plain'
                                    })
                                });
                            })
                        );
                    });
                `;
                
                const blob = new Blob([swContent], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                navigator.serviceWorker.register(swUrl).catch(() => {});
            }
        });
    </script>
</body>
</html>