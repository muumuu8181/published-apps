<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí∞ Smart Money Manager | Personal Finance Tracker</title>
    <meta name="description" content="ÂèéÂÖ•„Å®ÊîØÂá∫„ÇíÁÆ°ÁêÜ„Åó„ÄÅCSV„Åß„Éá„Éº„Çø„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Çã„ÅäÈáëÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjE4MCIgaGVpZ2h0PSIxODAiIGZpbGw9IiMwMDcwNDAiLz48Y2lyY2xlIGN4PSI5MCIgY3k9IjkwIiByPSIzMCIgZmlsbD0iI0ZGRiIvPjx0ZXh0IHg9IjkwIiB5PSIxMDAiIGZpbGw9IiMwMDcwNDAiIGZvbnQtZmFtaWx5PSJzZXJpZiIgZm9udC1zaXplPSIzMiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+JDwvdGV4dD48L3N2Zz4=">
    <style>
        :root {
            --primary-green: #007040;
            --light-green: #e8f5e8;
            --danger-red: #dc3545;
            --light-red: #ffeef0;
            --success-blue: #0056b3;
            --background-gray: #f8f9fa;
            --text-dark: #2c3e50;
            --border-light: #e1e8ed;
            --shadow-soft: 0 2px 8px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--background-gray) 0%, #ffffff 100%);
            color: var(--text-dark);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-green), #005530);
            color: white;
            border-radius: 15px;
            box-shadow: var(--shadow-soft);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
            text-align: center;
            border-top: 4px solid var(--primary-green);
        }

        .stat-card.income {
            border-top-color: var(--success-blue);
        }

        .stat-card.expense {
            border-top-color: var(--danger-red);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .stat-value.income {
            color: var(--success-blue);
        }

        .stat-value.expense {
            color: var(--danger-red);
        }

        .stat-value.balance {
            color: var(--primary-green);
        }

        .stat-label {
            font-size: 0.95rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
            margin-bottom: 30px;
        }

        .form-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-green);
            font-weight: 600;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
        }

        .form-control {
            padding: 12px 15px;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-green);
            background: white;
            box-shadow: 0 0 0 3px rgba(0, 112, 64, 0.1);
        }

        .form-control[type="number"] {
            font-weight: 600;
        }

        .btn {
            background: var(--primary-green);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            background: #005530;
            transform: translateY(-2px);
            box-shadow: var(--shadow-soft);
        }

        .btn-danger {
            background: var(--danger-red);
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-success {
            background: var(--success-blue);
        }

        .btn-success:hover {
            background: #004085;
        }

        .actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .transactions-section {
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
            overflow: hidden;
        }

        .section-header {
            background: var(--light-green);
            padding: 20px;
            border-bottom: 1px solid var(--border-light);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-green);
        }

        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: grid;
            grid-template-columns: 120px 1fr 120px 120px 80px;
            gap: 15px;
            padding: 15px 20px;
            border-bottom: 1px solid #f0f0f0;
            align-items: center;
            transition: background 0.2s ease;
        }

        .transaction-item:hover {
            background: #f8f9fa;
        }

        .transaction-date {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .transaction-description {
            font-weight: 500;
        }

        .transaction-amount {
            font-weight: 700;
            text-align: right;
        }

        .transaction-amount.income {
            color: var(--success-blue);
        }

        .transaction-amount.expense {
            color: var(--danger-red);
        }

        .transaction-type {
            font-size: 0.8rem;
            padding: 4px 8px;
            border-radius: 4px;
            text-align: center;
            font-weight: 600;
            text-transform: uppercase;
        }

        .transaction-type.income {
            background: #e3f2fd;
            color: var(--success-blue);
        }

        .transaction-type.expense {
            background: #ffebee;
            color: var(--danger-red);
        }

        .transaction-actions {
            display: flex;
            gap: 5px;
        }

        .btn-small {
            padding: 6px 10px;
            font-size: 0.8rem;
            border-radius: 4px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .edit-form {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
        }

        .edit-form h4 {
            color: #856404;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .transaction-item {
                grid-template-columns: 1fr;
                gap: 8px;
                text-align: left;
            }
            
            .transaction-amount {
                text-align: left !important;
            }
        }

        .filter-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-soft);
            margin-bottom: 20px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            align-items: end;
        }

        .total-summary {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--primary-green);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Smart Money Manager</h1>
            <p>ÂèéÂÖ•„ÉªÊîØÂá∫„ÇíÂäπÁéáÁöÑ„Å´ÁÆ°ÁêÜ„Åó„ÄÅË≤°ÂãôÁä∂Ê≥Å„ÇíÂèØË¶ñÂåñ„Åô„Çã„Ç∑„Çπ„ÉÜ„É†</p>
        </div>

        <!-- „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ -->
        <div class="dashboard">
            <div class="stat-card income">
                <div class="stat-value income" id="totalIncome">¬•0</div>
                <div class="stat-label">Á∑èÂèéÂÖ•</div>
            </div>
            <div class="stat-card expense">
                <div class="stat-value expense" id="totalExpense">¬•0</div>
                <div class="stat-label">Á∑èÊîØÂá∫</div>
            </div>
            <div class="stat-card">
                <div class="stat-value balance" id="totalBalance">¬•0</div>
                <div class="stat-label">ÊÆãÈ´ò</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="transactionCount">0</div>
                <div class="stat-label">ÂèñÂºï‰ª∂Êï∞</div>
            </div>
        </div>

        <!-- ÂèñÂºïÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
        <div class="form-section">
            <h2 class="form-title">üí∏ Êñ∞Ë¶èÂèñÂºï„ÇíËøΩÂä†</h2>
            <form id="transactionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="type">ÂèñÂºïÁ®ÆÈ°û</label>
                        <select id="type" class="form-control" required>
                            <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                            <option value="income">ÂèéÂÖ•</option>
                            <option value="expense">ÊîØÂá∫</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="amount">ÈáëÈ°ç (¬•)</label>
                        <input type="number" id="amount" class="form-control" min="1" step="1" required placeholder="‰æã: 50000">
                    </div>
                    <div class="form-group">
                        <label for="description">ÂÜÖÂÆπË™¨Êòé</label>
                        <input type="text" id="description" class="form-control" required placeholder="‰æã: Áµ¶‰∏é„ÄÅÈ£üË≤ª„ÄÅÂÖâÁÜ±Ë≤ª„Å™„Å©">
                    </div>
                    <div class="form-group">
                        <label for="date">Êó•‰ªò</label>
                        <input type="date" id="date" class="form-control" required>
                    </div>
                </div>
                <button type="submit" class="btn">üíæ ÂèñÂºï„ÇíËøΩÂä†</button>
            </form>
        </div>

        <!-- Á∑®ÈõÜ„Éï„Ç©„Éº„É† (ÈùûË°®Á§∫) -->
        <div id="editForm" class="edit-form" style="display: none;">
            <h4>üìù ÂèñÂºï„ÇíÁ∑®ÈõÜ</h4>
            <div class="form-grid">
                <div class="form-group">
                    <label for="editType">ÂèñÂºïÁ®ÆÈ°û</label>
                    <select id="editType" class="form-control" required>
                        <option value="income">ÂèéÂÖ•</option>
                        <option value="expense">ÊîØÂá∫</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editAmount">ÈáëÈ°ç (¬•)</label>
                    <input type="number" id="editAmount" class="form-control" min="1" step="1" required>
                </div>
                <div class="form-group">
                    <label for="editDescription">ÂÜÖÂÆπË™¨Êòé</label>
                    <input type="text" id="editDescription" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="editDate">Êó•‰ªò</label>
                    <input type="date" id="editDate" class="form-control" required>
                </div>
            </div>
            <div style="margin-top: 15px;">
                <button type="button" class="btn btn-success" onclick="saveEdit()">üíæ Â§âÊõ¥„Çí‰øùÂ≠ò</button>
                <button type="button" class="btn btn-danger" onclick="cancelEdit()">‚ùå „Ç≠„É£„É≥„Çª„É´</button>
            </div>
        </div>

        <!-- „Éï„Ç£„É´„Çø„Éº„Éª„Ç¢„ÇØ„Ç∑„Éß„É≥ -->
        <div class="filter-section">
            <div class="filter-grid">
                <div class="form-group">
                    <label for="filterType">ÂèñÂºïÁ®ÆÈ°û„Éï„Ç£„É´„Çø„Éº</label>
                    <select id="filterType" class="form-control" onchange="filterTransactions()">
                        <option value="">„Åô„Åπ„Å¶Ë°®Á§∫</option>
                        <option value="income">ÂèéÂÖ•„ÅÆ„Åø</option>
                        <option value="expense">ÊîØÂá∫„ÅÆ„Åø</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filterMonth">ÊúàÂà•„Éï„Ç£„É´„Çø„Éº</label>
                    <input type="month" id="filterMonth" class="form-control" onchange="filterTransactions()">
                </div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <button type="button" class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è ÂÖ®„Éá„Éº„ÇøÂâäÈô§</button>
                </div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <button type="button" class="btn btn-success" onclick="downloadCSV()">üìä CSV „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
                </div>
            </div>
        </div>

        <!-- ÂèñÂºïÂ±•Ê≠¥ -->
        <div class="transactions-section">
            <div class="section-header">
                <h2 class="section-title">üìã ÂèñÂºïÂ±•Ê≠¥</h2>
            </div>
            <div class="transaction-list" id="transactionList">
                <div class="empty-state">
                    <p>üìù „Åæ„Å†ÂèñÂºï„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
                    <p>‰∏ä„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÂèéÂÖ•„ÇÑÊîØÂá∫„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                </div>
            </div>
            <div class="total-summary" id="filterSummary" style="display: none;">
                <strong>„Éï„Ç£„É´„Çø„ÉºÁµêÊûú: ÂèéÂÖ• <span id="filteredIncome">¬•0</span> | ÊîØÂá∫ <span id="filteredExpense">¬•0</span> | Â∑ÆÈ°ç <span id="filteredBalance">¬•0</span></strong>
            </div>
        </div>
    </div>

    <script>
        class MoneyManager {
            constructor() {
                this.transactions = JSON.parse(localStorage.getItem('transactions')) || [];
                this.editingIndex = -1;
                this.init();
            }

            init() {
                // ‰ªäÊó•„ÅÆÊó•‰ªò„Çí„Éá„Éï„Ç©„É´„ÉàË®≠ÂÆö
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('date').value = today;
                
                // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
                document.getElementById('transactionForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addTransaction();
                });
                
                this.renderTransactions();
                this.updateDashboard();
            }

            addTransaction() {
                const type = document.getElementById('type').value;
                const amount = parseFloat(document.getElementById('amount').value);
                const description = document.getElementById('description').value.trim();
                const date = document.getElementById('date').value;

                if (!type || !amount || !description || !date) {
                    alert('‚ùå „Åô„Åπ„Å¶„ÅÆÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const transaction = {
                    id: Date.now(),
                    type,
                    amount,
                    description,
                    date,
                    createdAt: new Date().toISOString()
                };

                this.transactions.push(transaction);
                this.saveToStorage();
                this.renderTransactions();
                this.updateDashboard();
                
                // „Éï„Ç©„Éº„É†„É™„Çª„ÉÉ„Éà
                document.getElementById('transactionForm').reset();
                document.getElementById('date').value = new Date().toISOString().split('T')[0];
                
                // ÊàêÂäü„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
                this.showSuccess('‚úÖ ÂèñÂºï„ÅåÊ≠£Â∏∏„Å´ËøΩÂä†„Åï„Çå„Åæ„Åó„Åü');
            }

            editTransaction(index) {
                this.editingIndex = index;
                const transaction = this.transactions[index];
                
                document.getElementById('editType').value = transaction.type;
                document.getElementById('editAmount').value = transaction.amount;
                document.getElementById('editDescription').value = transaction.description;
                document.getElementById('editDate').value = transaction.date;
                
                document.getElementById('editForm').style.display = 'block';
                document.getElementById('editForm').scrollIntoView({ behavior: 'smooth' });
            }

            saveEdit() {
                if (this.editingIndex === -1) return;

                const type = document.getElementById('editType').value;
                const amount = parseFloat(document.getElementById('editAmount').value);
                const description = document.getElementById('editDescription').value.trim();
                const date = document.getElementById('editDate').value;

                if (!type || !amount || !description || !date) {
                    alert('‚ùå „Åô„Åπ„Å¶„ÅÆÈ†ÖÁõÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                this.transactions[this.editingIndex] = {
                    ...this.transactions[this.editingIndex],
                    type,
                    amount,
                    description,
                    date,
                    updatedAt: new Date().toISOString()
                };

                this.saveToStorage();
                this.renderTransactions();
                this.updateDashboard();
                this.cancelEdit();
                
                this.showSuccess('‚úÖ ÂèñÂºï„ÅåÊ≠£Â∏∏„Å´Êõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü');
            }

            cancelEdit() {
                this.editingIndex = -1;
                document.getElementById('editForm').style.display = 'none';
            }

            deleteTransaction(index) {
                if (confirm('üóëÔ∏è „Åì„ÅÆÂèñÂºï„ÇíÂâäÈô§„Åó„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü')) {
                    this.transactions.splice(index, 1);
                    this.saveToStorage();
                    this.renderTransactions();
                    this.updateDashboard();
                    this.showSuccess('‚úÖ ÂèñÂºï„ÅåÂâäÈô§„Åï„Çå„Åæ„Åó„Åü');
                }
            }

            renderTransactions() {
                const filteredTransactions = this.getFilteredTransactions();
                const listElement = document.getElementById('transactionList');
                
                if (filteredTransactions.length === 0) {
                    listElement.innerHTML = `
                        <div class="empty-state">
                            <p>üìù Ë°®Á§∫„Åô„ÇãÂèñÂºï„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                            <p>„Éï„Ç£„É´„Çø„Éº„ÇíÂ§âÊõ¥„Åô„Çã„Åã„ÄÅÊñ∞„Åó„ÅÑÂèñÂºï„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                        </div>
                    `;
                    document.getElementById('filterSummary').style.display = 'none';
                    return;
                }

                listElement.innerHTML = filteredTransactions.map((transaction, index) => {
                    const originalIndex = this.transactions.indexOf(transaction);
                    return `
                        <div class="transaction-item">
                            <div class="transaction-date">${this.formatDate(transaction.date)}</div>
                            <div class="transaction-description">${transaction.description}</div>
                            <div class="transaction-amount ${transaction.type}">
                                ${transaction.type === 'income' ? '+' : '-'}¬•${transaction.amount.toLocaleString()}
                            </div>
                            <div class="transaction-type ${transaction.type}">
                                ${transaction.type === 'income' ? 'ÂèéÂÖ•' : 'ÊîØÂá∫'}
                            </div>
                            <div class="transaction-actions">
                                <button class="btn btn-success btn-small" onclick="moneyManager.editTransaction(${originalIndex})" title="Á∑®ÈõÜ">
                                    üìù
                                </button>
                                <button class="btn btn-danger btn-small" onclick="moneyManager.deleteTransaction(${originalIndex})" title="ÂâäÈô§">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

                this.updateFilterSummary(filteredTransactions);
            }

            getFilteredTransactions() {
                const typeFilter = document.getElementById('filterType').value;
                const monthFilter = document.getElementById('filterMonth').value;
                
                return this.transactions.filter(transaction => {
                    const typeMatch = !typeFilter || transaction.type === typeFilter;
                    const monthMatch = !monthFilter || transaction.date.startsWith(monthFilter);
                    return typeMatch && monthMatch;
                }).sort((a, b) => new Date(b.date) - new Date(a.date));
            }

            updateFilterSummary(filteredTransactions) {
                const income = filteredTransactions
                    .filter(t => t.type === 'income')
                    .reduce((sum, t) => sum + t.amount, 0);
                    
                const expense = filteredTransactions
                    .filter(t => t.type === 'expense')
                    .reduce((sum, t) => sum + t.amount, 0);
                    
                const balance = income - expense;

                document.getElementById('filteredIncome').textContent = `¬•${income.toLocaleString()}`;
                document.getElementById('filteredExpense').textContent = `¬•${expense.toLocaleString()}`;
                document.getElementById('filteredBalance').textContent = `¬•${balance.toLocaleString()}`;
                document.getElementById('filteredBalance').style.color = balance >= 0 ? 'var(--success-blue)' : 'var(--danger-red)';
                
                document.getElementById('filterSummary').style.display = 'block';
            }

            updateDashboard() {
                const income = this.transactions
                    .filter(t => t.type === 'income')
                    .reduce((sum, t) => sum + t.amount, 0);
                    
                const expense = this.transactions
                    .filter(t => t.type === 'expense')
                    .reduce((sum, t) => sum + t.amount, 0);
                    
                const balance = income - expense;
                const count = this.transactions.length;

                document.getElementById('totalIncome').textContent = `¬•${income.toLocaleString()}`;
                document.getElementById('totalExpense').textContent = `¬•${expense.toLocaleString()}`;
                document.getElementById('totalBalance').textContent = `¬•${balance.toLocaleString()}`;
                document.getElementById('transactionCount').textContent = count.toLocaleString();

                // ÊÆãÈ´ò„ÅÆËâ≤Â§âÊõ¥
                const balanceElement = document.getElementById('totalBalance');
                if (balance > 0) {
                    balanceElement.className = 'stat-value balance';
                } else if (balance < 0) {
                    balanceElement.className = 'stat-value expense';
                } else {
                    balanceElement.className = 'stat-value';
                }
            }

            downloadCSV() {
                if (this.transactions.length === 0) {
                    alert('üìù „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åô„ÇãÂèñÂºï„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return;
                }

                const headers = ['Êó•‰ªò', 'Á®ÆÈ°û', 'ÈáëÈ°ç', 'ÂÜÖÂÆπ', '‰ΩúÊàêÊó•ÊôÇ'];
                const csvContent = [
                    headers.join(','),
                    ...this.transactions.map(t => [
                        t.date,
                        t.type === 'income' ? 'ÂèéÂÖ•' : 'ÊîØÂá∫',
                        t.amount,
                        `"${t.description}"`,
                        t.createdAt
                    ].join(','))
                ].join('\n');

                const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `money_manager_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();

                this.showSuccess('üìä CSV„Éï„Ç°„Ç§„É´„Åå„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åï„Çå„Åæ„Åó„Åü');
            }

            clearAllData() {
                if (confirm('‚ö†Ô∏è ÂÖ®„Å¶„ÅÆ„Éá„Éº„Çø„ÇíÂâäÈô§„Åó„Å¶„ÇÇ„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü\n„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇ')) {
                    if (confirm('üö® Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºüÂÖ®„Å¶„ÅÆÂèñÂºïÂ±•Ê≠¥„ÅåÂ§±„Çè„Çå„Åæ„Åô„ÄÇ')) {
                        this.transactions = [];
                        this.saveToStorage();
                        this.renderTransactions();
                        this.updateDashboard();
                        this.showSuccess('üóëÔ∏è ÂÖ®„Éá„Éº„Çø„ÅåÂâäÈô§„Åï„Çå„Åæ„Åó„Åü');
                    }
                }
            }

            filterTransactions() {
                this.renderTransactions();
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                });
            }

            saveToStorage() {
                localStorage.setItem('transactions', JSON.stringify(this.transactions));
            }

            showSuccess(message) {
                // Á∞°ÊòìÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫
                const originalTitle = document.title;
                document.title = message;
                setTimeout(() => {
                    document.title = originalTitle;
                }, 3000);
            }
        }

        // „Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞ÔºàHTML onclickÁî®Ôºâ
        function filterTransactions() {
            moneyManager.filterTransactions();
        }

        function downloadCSV() {
            moneyManager.downloadCSV();
        }

        function clearAllData() {
            moneyManager.clearAllData();
        }

        function saveEdit() {
            moneyManager.saveEdit();
        }

        function cancelEdit() {
            moneyManager.cancelEdit();
        }

        // „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂàùÊúüÂåñ
        const moneyManager = new MoneyManager();

        // PWAÂØæÂøú
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(registrationError => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>